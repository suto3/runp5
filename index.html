<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Scrapboxコード実行</title>
    <!--
    <script src="//code.jquery.com/jquery-latest.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.6/p5.js"></script>
    -->

    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.19/themes/redmond/jquery-ui.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.19/jquery-ui.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.19/i18n/jquery-ui-i18n.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/p5.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.dom.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/addons/p5.sound.js"></script>

    <script>
      $(function(){
        args = {}
        document.location.search.substring(1).split('&').map((s) => {
          [name,value] = s.split('=')
          args[name] = decodeURIComponent(value)
        })
        codelist = args['code']
        if(codelist){
          codes = codelist.split(/,/)
          for(i=0;i<codes.length;i++){
            code = codes[i]
            script=$('<script>')
            script.attr('src',code)
            $('body').append(script)
            
            projectDirs = code.split('/code/')[1].split('/')
            projectURL = 'https://scrapbox.io'
            for(i=0; i<projectDirs.length-1 ;i++ ){
              projectURL += '/'+projectDirs[i] 
            }
            
            link = $('<a>[source]</a>')
            link.attr('href',projectURL)
            $('#link').append(link)
          }
        }
      })
      </script>
  </head>
  <body>
  <p id="link"></p>
  </body>
</html>
